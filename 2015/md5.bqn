Hash â‡ { (MD5 @).Digest ğ•© }
MD5 â‡ {ğ•¤
 Unpack â† { 2 |âŒŠğ•© Ã· 2â‹†âŒ½â†•ğ•¨ }
 Pack â† { +Â´ ğ•© Ã— 2â‹†âŒ½â†•ğ•¨ }
 Xor â† âˆ¨-âˆ§
 K â† {âŒŠ|(2â‹†32)Ã—â€¢math.Sin 1+ğ•©}
 Int â† 32âŠ¸Pack
 Bits â† 32âŠ¸Unpack
 ToLittleEndian â† { +Â´ (256â‹†â†•4) Ã— 8 PackË˜ 4â€¿8 â¥Š ğ•© }
 FromLittleEndian â† { âˆ¾Â´ âŒ½ 8 UnpackÂ¨ 256 | âŒŠğ•© Ã· 256â‹†âŒ½â†•4 }
 shifts â† 4â€¿4 â¥Š 7â€¿12â€¿17â€¿22â€¿5â€¿9â€¿14â€¿20â€¿4â€¿11â€¿16â€¿23â€¿6â€¿10â€¿15â€¿21
 state â† a0â€¿b0â€¿c0â€¿d0 â† 1732584193â€¿4023233417â€¿2562379262â€¿271733878
 Chunk â† {
    F â† {xâ€¿yâ€¿z â† BitsÂ¨ğ•© â‹„ Int (xâˆ§y)âˆ¨(Â¬x)âˆ§z}
    G â† {xâ€¿yâ€¿z â† BitsÂ¨ğ•© â‹„ Int (xâˆ§z)âˆ¨yâˆ§Â¬z}
    H â† {xâ€¿yâ€¿z â† BitsÂ¨ğ•© â‹„ Int x Xor y Xor z}
    I â† {xâ€¿yâ€¿z â† BitsÂ¨ğ•© â‹„ Int y Xor x âˆ¨ Â¬ z}
    s â† state
    msg â† ToLittleEndianË˜16â€¿32 â¥Š ğ•©
    {
      round â† âŒŠğ•© Ã· 16
      phase â† 4|ğ•©
      â€¢Show roundâ€¿phase
      op â† round âŠ‘ Fâ€¿Gâ€¿Hâ€¿I
      shift â† roundâ€¿phase âŠ‘ shifts
      r â† phaseâŒ½s
      sel â† round âŠ‘ âŠ¢â€¿{16|1+5Ã—ğ•©}â€¿{16|5+3Ã—ğ•©}â€¿{16|7Ã—ğ•©}
      h â† (2â‹†32) | (1âŠr) + Int shift âŒ½ Bits ((âŠr) + (Op 1â†“r) + ((Sel ğ•©)âŠmsg) + K ğ•©)
      s â†© (-phase) âŒ½ h âˆ¾ 1â†“r
      â€¢Show s
    }Â¨â†•64
    state â†© state + s
  }
  
  Preprocess â‡ { # ğ•© is a byte array
    bits â† 1â†“0 âˆ¾Â´ 8 UnpackÂ¨ ğ•©
    pad  â† 512 - 512 | â‰ bits # number of padding bits
    bits â†© bits âˆ¾ 1
    bits â†© bits âˆ¾ (512|pad-65)â†‘0
    bits â†© bits âˆ¾ 64 Unpack 8Ã—â‰ ğ•© # todo: change to little-endian
    numChunks â† (â‰ bits)Ã·512
    chunks â† numChunksâ€¿512 â¥Š bits
    chunks
  }
  Digest â‡ {
    chunks â† Preprocess ğ•©
    ChunkË˜chunks
    Hash @
   }
  Hash â‡ { ğ•© âŠ¢ âˆ¾Â´ HexadecimalÂ¨ 8 PackË˜ 16â€¿8 â¥Š âˆ¾Â´ BitsÂ¨a0â€¿b0â€¿c0â€¿d0 }
 }
Hexadecimal â† { âŸ¨âŒŠğ•©Ã·16â‹„16|ğ•©âŸ© âŠâ‰0â€¿âˆ "0123456789abcdef" }
Tests â‡ {ğ•¤
 SimpleHashMatches â† {ğ•¤
  digest â† MD5 @
  hash â† digest.Digest "The quick brown fox jumps over the lazy dog" - @
  hash â‰¡ "9e107d9d372bb6826bd81d3542a419d6"
  }
 SimpleHashPeriodMatches â† {ğ•¤
  digest â† MD5 @
  hash â† digest.Digest "The quick brown fox jumps over the lazy dog." - @
  hash â‰¡ "e4d909c290d0fb1ca068ffaddf22cbd0"
  }
 EmptyHashMatches â† {ğ•¤
   digest â† MD5 @
   hash â† digest.Digest "" - @
   hash â‰¡ "d41d8cd98f00b204e9800998ecf8427e"
  }

  âŸ¨"Simple Hash Matches"â€¿(SimpleHashMatches @) â‹„
   "Simple Hash With Period Matches"â€¿(SimpleHashPeriodMatches @) â‹„
   "Empty Hash Matches"â€¿(EmptyHashMatches @)âŸ©
 }
