MD5 â‡ {ğ•¤
 Unpack â† { 2 |âŒŠğ•© Ã· 2â‹†âŒ½â†•ğ•¨ }
 Pack â† { +Â´ ğ•© Ã— 2â‹†âŒ½â†•ğ•¨ }
 Xor â† âˆ¨-âˆ§
 K â† {âŒŠ(2â‹†32)||(2â‹†32)Ã—â€¢math.Sin 1+ğ•©}
 #Int â† { +Â´ (256â‹†â†•4) Ã— 8 PackË˜ 4â€¿8 â¥Š ğ•© }
 Int â† 32âŠ¸Pack
 #Bits â† { âˆ¾Â´ âŒ½ 8 UnpackÂ¨ 256 | âŒŠğ•© Ã· 256â‹†âŒ½â†•4 }
 Bits â† 32âŠ¸Unpack
 shifts â† (16â†‘7â€¿12â€¿17â€¿22)âˆ¾(16â†‘5â€¿9â€¿14â€¿20)âˆ¾(16â†‘4â€¿11â€¿16â€¿23)âˆ¾(16â†‘6â€¿10â€¿15â€¿21)
 a0â€¿b0â€¿c0â€¿d0 â† 1732584193â€¿4023233417â€¿2562383102â€¿271733878
 Chunk â† {
     m â† IntË˜ 16â€¿32 â¥Š ğ•© # ğ•© is given as a single 512-bit array
     f â† 0
     aâ€¿bâ€¿câ€¿d â† BitsÂ¨a0â€¿b0â€¿c0â€¿d0
     Update â† {ğ•¤
       f â†© (2â‹†32) | f + (Int a) + (K ğ•©) + ğ•©âŠ‘m
       a â†© d
       d â†© c
       c â†© b
       b â†© Bits (Int b) + Int (ğ•© âŠ‘ shifts) âŒ½ Bits f
     }
     { f â†© Int (bâˆ§c)âˆ¨(Â¬b)âˆ§ d â‹„ Update ğ•© }Â¨â†•16
     { f â†© Int (dâˆ§b)âˆ¨   câˆ§Â¬d â‹„ Update 16 | 1 + 5Ã—ğ•© }Â¨16+â†•16
     { f â†© Int b Xor c Xor d â‹„ Update 16 | 5 + 3Ã—ğ•© }Â¨32+â†•16
     { f â†© Int c Xor b âˆ¨  Â¬d â‹„ Update 16 | 7Ã—ğ•© }Â¨48+â†•16
     a0 â†© (2â‹†32) | a0 + Int a
     b0 â†© (2â‹†32) | b0 + Int b
     c0 â†© (2â‹†32) | c0 + Int c
     d0 â†© (2â‹†32) | d0 + Int d
  }
  Preprocess â† { # ğ•© is a byte array
    bits â† 1â†“0 âˆ¾Â´ 8 UnpackÂ¨ ğ•©
    pad  â† 512 - 512 | â‰ bits # number of padding bits
    bits â†© bits âˆ¾ 1
    bits â†© bits âˆ¾ (512|pad-65)â†‘0
    bits â†© bits âˆ¾ 64 Unpack 8Ã—â‰ ğ•©
    numChunks â† (â‰ bits)Ã·512
    chunks â† numChunksâ€¿512 â¥Š bits
    chunks
  }
  Digest â‡ {
    chunks â† Preprocess ğ•©
    ChunkË˜chunks
    Hash @
   }
  Hash â‡ { ğ•© âŠ¢ âˆ¾Â´ HexadecimalÂ¨ 8 PackË˜ 16â€¿8 â¥Š âˆ¾Â´ BitsÂ¨a0â€¿b0â€¿c0â€¿d0 }
 }

Hexadecimal â† { âŸ¨âŒŠğ•©Ã·16â‹„16|ğ•©âŸ© âŠâ‰0â€¿âˆ "0123456789abcdef" }
Tests â‡ {ğ•¤
 SimpleHashMatches â† {ğ•¤
  digest â† MD5 @
  hash â† digest.Digest "The quick brown fox jumps over the lazy dog" - @
  hash â‰¡ "9e107d9d372bb6826bd81d3542a419d6"
  }
 SimpleHashPeriodMatches â† {ğ•¤
  digest â† MD5 @
  hash â† digest.Digest "The quick brown fox jumps over the lazy dog." - @
  hash â‰¡ "e4d909c290d0fb1ca068ffaddf22cbd0"
  }
 EmptyHashMatches â† {ğ•¤
   digest â† MD5 @
   hash â† digest.Digest "" - @
   hash â‰¡ "d41d8cd98f00b204e9800998ecf8427e"
  }

  âŸ¨"Simple Hash Matches"â€¿(SimpleHashMatches @) â‹„
   "Simple Hash With Period Matches"â€¿(SimpleHashPeriodMatches @) â‹„
   "Empty Hash Matches"â€¿(EmptyHashMatches @)âŸ©
 }
