map   â† > â€¢file.Lines "6.in"
Coord â† â‰ âˆ˜âŠ (âŒŠâˆ˜Ã·Ëœ â‹ˆ |) âŠ‘âˆ˜/âˆ˜â¥Š
start â† Coord mask â† map = '^'
dirs  â† âŸ¨"up","right","down","left"âŸ©
basis â† âŸ¨Â¯1â€¿0, 0â€¿1, 1â€¿0, 0â€¿Â¯1âŸ©
views â† âŸ¨
 âŒ½ (1 + âŠ‘âˆ˜âŠ£)   â†‘ 1âŠ¸âŠ‘âˆ˜âŠ£ âŠË˜ âŠ¢, # up
 (1âŠ¸âŠ‘âˆ˜âŠ£)       â†“   âŠ‘âˆ˜âŠ£ âŠ  âŠ¢, # right
   (âŠ‘âˆ˜âŠ£)       â†“ 1âŠ¸âŠ‘âˆ˜âŠ£ âŠË˜ âŠ¢, # down
 âŒ½ (1 + 1âŠ¸âŠ‘)âˆ˜âŠ£ â†‘   âŠ‘âˆ˜âŠ£ âŠ  âŠ¢  # left
 âŸ©
DX â† âŠ‘âˆ˜/ dirs â‰¡âš‡1â€¿âˆ âŠ¢
Rot â† {(4|1+DX ğ•©)âŠ‘dirs}
Walk â† {ğ•ŠâŸ¨x,yâŸ©â€¿mapâ€¿maskâ€¿dirâ€¿posnsâ€¿uâ€¿done:
 v    â† (DX dir)âŠ‘views
 saw  â† âŸ¨x, yâŸ© V map
 move â† âˆ§` '#' â‰  saw
 next â† (move âˆ¨ âŠ¢)âŒ¾( âŸ¨x, yâŸ© V âŠ¢) mask
 nd   â† Rot dir
 b    â† basis âŠ‘Ëœ DX dir
 n    â† (xâ€¿y + (Â¯1âŠ‘/move) Ã— b)
 nn   â† n âˆ¾ <nd
 rep  â† âˆ¨Â´ nn â‰¡âš‡2 posns
 nâ€¿mapâ€¿nextâ€¿ndâ€¿(nn <âŠ¸âˆ¾ posns)â€¿repâ€¿(rep âˆ¨ âˆ§Â´move)
}
p1 â† +Â´ â¥Š 2 âŠ‘ w â† Walk â€¢_while_ (Â¬Â¯1âŠ‘âŠ¢) âŸ¨start, map, mask, "up", âŸ¨startâˆ¾<"up"âŸ©, 0, 0âŸ©
p2 â† +Â´ {Â¯2 âŠ‘ Walk â€¢_while_ (Â¬Â¯1âŠ‘âŠ¢) âŸ¨start, '#'âŒ¾(ğ•© âŠ‘ âŠ¢) map, mask, "up", âŸ¨startâˆ¾<"up"âŸ©, 0, 0âŸ©}Â¨ (â¥Š(2âŠ‘w)âˆ§Â¬mask)âŠ¸/ â¥Šâ†•â‰¢map
