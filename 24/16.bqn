maze   â† >â€¢file.Lines "16.in"
# N E S W
basis  â† âŸ¨Â¯1â€¿0,0â€¿1,1â€¿0,0â€¿Â¯1âŸ©
start  â† âŸ¨(â‰ maze)-2, 1âŸ©
end    â† âŸ¨1, (â‰ maze)-2âŸ©
scores â† âŸ¨1000,0,1000,2000âŸ©âŒ¾(start âŠ‘ âŠ¢) (4â¥Šâˆ)Â¨ maze
steps  â† (-â†•4) âŒ½Â¨ <âŸ¨1,1001,2001,1001âŸ©
Advance â† { ğ•Šscoresâ€¿set:
  adj â† set +âŒœ basis
  exi â† adj âŠ‘ scores
  new â† > (set âŠ‘ scores) +âš‡1â€¿2 steps
  imp â† âˆ¨Â´Â¨ new < exi
  leg â† (adj âŠ‘ maze) âˆŠ "SE."
  msk â† imp âˆ§ leg
  a   â† msk /â—‹â¥Š adj
  b   â† msk /â—‹â¥Š new âŒŠ exi
  c   â† âŒŠÂ´Â¨ a âŠâŠ¸âŠ” b
  scores câŒ¾((â·a)âŠ‘âŠ¢) â†©
  âŸ¨scores, â·msk/â—‹â¥ŠadjâŸ©
}
âŸ¨paths, Â·âŸ© â† Advance â€¢_while_ {0â‰ â‰ 1âŠ‘ğ•©} âŸ¨ scores, â‹ˆstartâŸ©
âŸ¨shtap, Â·âŸ© â† Advance â€¢_while_ {0â‰ â‰ 1âŠ‘ğ•©} âŸ¨0Â¨âŒ¾(endâŠ‘âŠ¢) (4â¥Šâˆ)Â¨ maze, â‹ˆendâŸ©
p1 â† âŒŠÂ´ âŸ¨1, (â‰ maze)-2âŸ© âŠ‘ paths
p2 â† +Â´ â¥Š (âŠ¢âˆ§Â·âˆ¨Â´âŸ¨Â«,Â»,Â«Ë˜,Â»Ë˜âŸ©{ğ•ğ•©}Â¨<) p1 â‰¥ shtap +â—‹(âŒŠÂ´Â¨) paths
