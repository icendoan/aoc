x:+`${(" "\:x)1 7}'1:"7.input";
a:{{x@<x}@(?((!k)@&.&/'(k:(*x)@=last x)in y),(*x)@&~(*x)in last x)^y};
p1:{{?y,*a[x;y]}[x]/`}
COST:60;N:5;
p2s:{D:*y;R:y 1;U:0=T:last y;A:(a[x;D,R@&U]^R@&~U)@!N;(?D,R@&U;{x[&y]:(+/y)#z;x}[R;U;A];{x[&y]:{$[^x;0;COST+*($x)-"A"]}'(+/y)#z;x:x-~y;x}[T;U;A])};
p2:{p2s[x]\(,`;N#`;N#0)}
