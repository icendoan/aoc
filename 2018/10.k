x:+{2 2#{x@&~^x}@`i$1_'(&+/"<>,"=\:x)_x}'1:"10.input";
D:*x;V:last x;
B:{((|/x);(&/x))}
R:{+|/x~/:/:\:g,/:\:g:(l+!(1+|//x)-l:(&//x))};
M:{sqrt+/v*v:(*x)-|last x:{((|/x);(&/x))}@D+V*x}
p1:{" #"R D+V*p2[]}
p2:{-1+*{(^M[x-1])|(^M[x])|(M[x-1]>M[x])} {x+1}/ 0}
